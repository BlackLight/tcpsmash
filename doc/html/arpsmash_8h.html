<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>tcpsmash: ARPsmash/arpsmash.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_0235b725062c186ed44d0b2ffe8355bb.html">ARPsmash</a>
  </div>
</div>
<div class="contents">
<h1>arpsmash.h File Reference</h1><code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;unistd.h&gt;</code><br>
<code>#include &lt;sys/signal.h&gt;</code><br>
<code>#include &lt;errno.h&gt;</code><br>
<code>#include &lt;arpa/inet.h&gt;</code><br>
<code>#include &lt;sys/socket.h&gt;</code><br>
<code>#include &lt;sys/ioctl.h&gt;</code><br>
<code>#include &lt;netinet/in.h&gt;</code><br>
<code>#include &lt;net/if.h&gt;</code><br>
<code>#include &lt;net/if_arp.h&gt;</code><br>
<code>#include &lt;net/ethernet.h&gt;</code><br>
<code>#include &lt;netpacket/packet.h&gt;</code><br>
<code>#include &lt;netdb.h&gt;</code><br>
<code>#include &lt;linux/if_ether.h&gt;</code><br>
<code>#include &lt;linux/ip.h&gt;</code><br>
<code>#include &lt;pthread.h&gt;</code><br>

<p>
<a href="arpsmash_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structarp__hdr.html">arp_hdr</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Struct to manage ARP headers.  <a href="structarp__hdr.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#1291f416b069313021b519eea62d5bf1">NORMAL</a>&nbsp;&nbsp;&nbsp;&quot;\033[0m&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#26cdbb1a00213c810caccf21cd33a631">BOLD</a>&nbsp;&nbsp;&nbsp;&quot;\033[1m&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#8d23feea868a983c8c2b661e1e16972f">RED</a>&nbsp;&nbsp;&nbsp;&quot;\033[91m&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#cfbc006ea433ad708fdee3e82996e721">GREEN</a>&nbsp;&nbsp;&nbsp;&quot;\033[92m&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#bf681265909adf3d3e8116c93c0ba179">YELLOW</a>&nbsp;&nbsp;&nbsp;&quot;\033[01;93m&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#d243f93c16bc4c1d3e0a13b84421d760">CYAN</a>&nbsp;&nbsp;&nbsp;&quot;\033[01;36m&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>&nbsp;&nbsp;&nbsp;&quot;0.3.2&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#45ba202b05caf39795aeca91b0ae547e">TIMEOUT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#62249e384b997229a3e2ae74ade334e2">DELAY</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#c01cd984dc1cb7e36ce015fa180e66b2">ETH_LEN</a>&nbsp;&nbsp;&nbsp;14</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#a266650932b0e54ba9a439f040661ff8">PACK_MAXSIZE</a>&nbsp;&nbsp;&nbsp;65535</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#7dbec1c798652ae8b6754cd5fcce24ad">SEND_DELAY</a>&nbsp;&nbsp;&nbsp;10000</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef unsigned short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#c915988d8c60a3b943f936c25f9eca6e">__u16</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#28635edf3ccf0b9034ad1e8a9c3bfc07">get_hw_addr</a> (char *<a class="el" href="arpsmash_8h.html#395cdf85c312ad98980787cc8c32f7d5">ifc</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It gets the HW address associated to a network interface.  <a href="#28635edf3ccf0b9034ad1e8a9c3bfc07"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#6995d03ff996b08ab0e5cf4023b1595e">get_host_addr</a> (<a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *host)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It returns IP addr of a host given its host name.  <a href="#6995d03ff996b08ab0e5cf4023b1595e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#0472c1b998fcdf27d3e680c08bd4fcca">get_ipv4_addr</a> (char *<a class="el" href="arpsmash_8h.html#395cdf85c312ad98980787cc8c32f7d5">ifc</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It gets the IP address associated to a network interface.  <a href="#0472c1b998fcdf27d3e680c08bd4fcca"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#a9385d03e0d4b1057d3645c46a65fff8">ifindex</a> (char *<a class="el" href="arpsmash_8h.html#395cdf85c312ad98980787cc8c32f7d5">ifc</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It gets the index of a network interface.  <a href="#a9385d03e0d4b1057d3645c46a65fff8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#514ad8556ae26bd6b615acd16d362589">doarp</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Main function.  <a href="#514ad8556ae26bd6b615acd16d362589"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#8b6e9b98a44692b925f9d54808f4ea20">arpsmash</a> (<a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *interface, <a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *addr1, <a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *addr2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This calls <a class="el" href="arper_8c.html#514ad8556ae26bd6b615acd16d362589" title="Main function.">doarp()</a> function initializating right values.  <a href="#8b6e9b98a44692b925f9d54808f4ea20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#dfdaa580d9b1fd44761d866788b63d55">handle</a> (int sig)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function does nothing.  <a href="#dfdaa580d9b1fd44761d866788b63d55"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#34d945fa25374bfd00b455f1e047e312">term</a> (int sig)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function called when exiting ARPsmash.  <a href="#34d945fa25374bfd00b455f1e047e312"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#777f08e1c4f275bbb9cf2b59c14f4e1e">die</a> (int ret)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function called whenever ARPsmash execution ends anomally.  <a href="#777f08e1c4f275bbb9cf2b59c14f4e1e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#e2aaced5f32f2db016d4b6d7767e515e">hw_addr</a> (void *arg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function associated to a thread that gets HW address of a given IP address analyzing its ARP replies.  <a href="#e2aaced5f32f2db016d4b6d7767e515e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#862b8ddac9b71494ccd26d484fb49ca3">forward</a> (void *arg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread for forwarding sniffed packets to the right targets.  <a href="#862b8ddac9b71494ccd26d484fb49ca3"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#06b0afe769d54ae94259d8532bc878b0">sd</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">All-purpose socket descriptor.  <a href="#06b0afe769d54ae94259d8532bc878b0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct sockaddr_ll&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#c1c1730f6aed981a7061ccfe767638c9">dlink</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data link sockaddr descriptor.  <a href="#c1c1730f6aed981a7061ccfe767638c9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#12c7a29c2aaefb6be3e9e2159acf74d9">t_hw</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">My HW address.  <a href="#12c7a29c2aaefb6be3e9e2159acf74d9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#ecbd64d70ba93895baf559fe1e51c240">t1_hw</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Targets' HW addresses.  <a href="#ecbd64d70ba93895baf559fe1e51c240"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#f05aa100ccc9224db3be71d851d301cd">t2_hw</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#d2d8915a351fd3579e33e34dc1e1b06d">t1</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Targets' names/addresses.  <a href="#d2d8915a351fd3579e33e34dc1e1b06d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#ff8d675c54f18c668a5f1edabf2a0e2c">t2</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="arpsmash_8h.html#395cdf85c312ad98980787cc8c32f7d5">ifc</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Network interface to sniff.  <a href="#395cdf85c312ad98980787cc8c32f7d5"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="26cdbb1a00213c810caccf21cd33a631"></a><!-- doxytag: member="arpsmash.h::BOLD" ref="26cdbb1a00213c810caccf21cd33a631" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOLD&nbsp;&nbsp;&nbsp;&quot;\033[1m&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="d243f93c16bc4c1d3e0a13b84421d760"></a><!-- doxytag: member="arpsmash.h::CYAN" ref="d243f93c16bc4c1d3e0a13b84421d760" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CYAN&nbsp;&nbsp;&nbsp;&quot;\033[01;36m&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="62249e384b997229a3e2ae74ade334e2"></a><!-- doxytag: member="arpsmash.h::DELAY" ref="62249e384b997229a3e2ae74ade334e2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DELAY&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="c01cd984dc1cb7e36ce015fa180e66b2"></a><!-- doxytag: member="arpsmash.h::ETH_LEN" ref="c01cd984dc1cb7e36ce015fa180e66b2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ETH_LEN&nbsp;&nbsp;&nbsp;14          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="cfbc006ea433ad708fdee3e82996e721"></a><!-- doxytag: member="arpsmash.h::GREEN" ref="cfbc006ea433ad708fdee3e82996e721" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GREEN&nbsp;&nbsp;&nbsp;&quot;\033[92m&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="1291f416b069313021b519eea62d5bf1"></a><!-- doxytag: member="arpsmash.h::NORMAL" ref="1291f416b069313021b519eea62d5bf1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NORMAL&nbsp;&nbsp;&nbsp;&quot;\033[0m&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="a266650932b0e54ba9a439f040661ff8"></a><!-- doxytag: member="arpsmash.h::PACK_MAXSIZE" ref="a266650932b0e54ba9a439f040661ff8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PACK_MAXSIZE&nbsp;&nbsp;&nbsp;65535          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="8d23feea868a983c8c2b661e1e16972f"></a><!-- doxytag: member="arpsmash.h::RED" ref="8d23feea868a983c8c2b661e1e16972f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RED&nbsp;&nbsp;&nbsp;&quot;\033[91m&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="7dbec1c798652ae8b6754cd5fcce24ad"></a><!-- doxytag: member="arpsmash.h::SEND_DELAY" ref="7dbec1c798652ae8b6754cd5fcce24ad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEND_DELAY&nbsp;&nbsp;&nbsp;10000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="45ba202b05caf39795aeca91b0ae547e"></a><!-- doxytag: member="arpsmash.h::TIMEOUT" ref="45ba202b05caf39795aeca91b0ae547e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TIMEOUT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="1c6d5de492ac61ad29aec7aa9a436bbf"></a><!-- doxytag: member="arpsmash.h::VERSION" ref="1c6d5de492ac61ad29aec7aa9a436bbf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VERSION&nbsp;&nbsp;&nbsp;&quot;0.3.2&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="bf681265909adf3d3e8116c93c0ba179"></a><!-- doxytag: member="arpsmash.h::YELLOW" ref="bf681265909adf3d3e8116c93c0ba179" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define YELLOW&nbsp;&nbsp;&nbsp;&quot;\033[01;93m&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="c915988d8c60a3b943f936c25f9eca6e"></a><!-- doxytag: member="arpsmash.h::__u16" ref="c915988d8c60a3b943f936c25f9eca6e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned short <a class="el" href="arpsmash_8h.html#c915988d8c60a3b943f936c25f9eca6e">__u16</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="b291f552d5fd4d65ac668d6b2b180919"></a><!-- doxytag: member="arpsmash.h::__u8" ref="b291f552d5fd4d65ac668d6b2b180919" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned char <a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8b6e9b98a44692b925f9d54808f4ea20"></a><!-- doxytag: member="arpsmash.h::arpsmash" ref="8b6e9b98a44692b925f9d54808f4ea20" args="(__u8 *interface, __u8 *addr1, __u8 *addr2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int arpsmash           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td>
          <td class="paramname"> <em>interface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td>
          <td class="paramname"> <em>addr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td>
          <td class="paramname"> <em>addr2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This calls <a class="el" href="arper_8c.html#514ad8556ae26bd6b615acd16d362589" title="Main function.">doarp()</a> function initializating right values. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Nothing if successful, a value &lt; 0 in case of error </dd></dl>

</div>
</div><p>
<a class="anchor" name="777f08e1c4f275bbb9cf2b59c14f4e1e"></a><!-- doxytag: member="arpsmash.h::die" ref="777f08e1c4f275bbb9cf2b59c14f4e1e" args="(int ret)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void die           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ret</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function called whenever ARPsmash execution ends anomally. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ret</em>&nbsp;</td><td>Return value </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="514ad8556ae26bd6b615acd16d362589"></a><!-- doxytag: member="arpsmash.h::doarp" ref="514ad8556ae26bd6b615acd16d362589" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int doarp           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Main function. 
<p>
It makes the poisoning loop <dl class="return" compact><dt><b>Returns:</b></dt><dd>Nothing if successful, a value &lt; 0 in case of error </dd></dl>

</div>
</div><p>
<a class="anchor" name="862b8ddac9b71494ccd26d484fb49ca3"></a><!-- doxytag: member="arpsmash.h::forward" ref="862b8ddac9b71494ccd26d484fb49ca3" args="(void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* forward           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Thread for forwarding sniffed packets to the right targets. 
<p>

</div>
</div><p>
<a class="anchor" name="6995d03ff996b08ab0e5cf4023b1595e"></a><!-- doxytag: member="arpsmash.h::get_host_addr" ref="6995d03ff996b08ab0e5cf4023b1595e" args="(__u8 *host)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>* get_host_addr           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> *&nbsp;</td>
          <td class="paramname"> <em>host</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It returns IP addr of a host given its host name. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>host</em>&nbsp;</td><td>Host name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>host's IP address </dd></dl>

</div>
</div><p>
<a class="anchor" name="28635edf3ccf0b9034ad1e8a9c3bfc07"></a><!-- doxytag: member="arpsmash.h::get_hw_addr" ref="28635edf3ccf0b9034ad1e8a9c3bfc07" args="(char *ifc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>* get_hw_addr           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ifc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It gets the HW address associated to a network interface. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ifc</em>&nbsp;</td><td>Interface name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>HW address </dd></dl>

</div>
</div><p>
<a class="anchor" name="0472c1b998fcdf27d3e680c08bd4fcca"></a><!-- doxytag: member="arpsmash.h::get_ipv4_addr" ref="0472c1b998fcdf27d3e680c08bd4fcca" args="(char *ifc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* get_ipv4_addr           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ifc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It gets the IP address associated to a network interface. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ifc</em>&nbsp;</td><td>Interface name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>IP address </dd></dl>

</div>
</div><p>
<a class="anchor" name="dfdaa580d9b1fd44761d866788b63d55"></a><!-- doxytag: member="arpsmash.h::handle" ref="dfdaa580d9b1fd44761d866788b63d55" args="(int sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handle           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sig</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function does nothing. 
<p>
It's just used to manage signals for which I want no direct action <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sig</em>&nbsp;</td><td>Signal number </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="e2aaced5f32f2db016d4b6d7767e515e"></a><!-- doxytag: member="arpsmash.h::hw_addr" ref="e2aaced5f32f2db016d4b6d7767e515e" args="(void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* hw_addr           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>arg</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function associated to a thread that gets HW address of a given IP address analyzing its ARP replies. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>arg</em>&nbsp;</td><td>IP addr </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="a9385d03e0d4b1057d3645c46a65fff8"></a><!-- doxytag: member="arpsmash.h::ifindex" ref="a9385d03e0d4b1057d3645c46a65fff8" args="(char *ifc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ifindex           </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>ifc</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It gets the index of a network interface. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ifc</em>&nbsp;</td><td>Interface name </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>-1 in case of error, network interface's index elsewhere </dd></dl>

</div>
</div><p>
<a class="anchor" name="34d945fa25374bfd00b455f1e047e312"></a><!-- doxytag: member="arpsmash.h::term" ref="34d945fa25374bfd00b455f1e047e312" args="(int sig)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void term           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>sig</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Function called when exiting ARPsmash. 
<p>
It re-ARPs target hosts correctly <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sig</em>&nbsp;</td><td>Signal number </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="c1c1730f6aed981a7061ccfe767638c9"></a><!-- doxytag: member="arpsmash.h::dlink" ref="c1c1730f6aed981a7061ccfe767638c9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct sockaddr_ll <a class="el" href="arpsmash_8h.html#c1c1730f6aed981a7061ccfe767638c9">dlink</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Data link sockaddr descriptor. 
<p>

</div>
</div><p>
<a class="anchor" name="395cdf85c312ad98980787cc8c32f7d5"></a><!-- doxytag: member="arpsmash.h::ifc" ref="395cdf85c312ad98980787cc8c32f7d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>* <a class="el" href="arpsmash_8h.html#395cdf85c312ad98980787cc8c32f7d5">ifc</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Network interface to sniff. 
<p>

</div>
</div><p>
<a class="anchor" name="06b0afe769d54ae94259d8532bc878b0"></a><!-- doxytag: member="arpsmash.h::sd" ref="06b0afe769d54ae94259d8532bc878b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="arpsmash_8h.html#06b0afe769d54ae94259d8532bc878b0">sd</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
All-purpose socket descriptor. 
<p>

</div>
</div><p>
<a class="anchor" name="d2d8915a351fd3579e33e34dc1e1b06d"></a><!-- doxytag: member="arpsmash.h::t1" ref="d2d8915a351fd3579e33e34dc1e1b06d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>* <a class="el" href="arpsmash_8h.html#d2d8915a351fd3579e33e34dc1e1b06d">t1</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Targets' names/addresses. 
<p>

</div>
</div><p>
<a class="anchor" name="ecbd64d70ba93895baf559fe1e51c240"></a><!-- doxytag: member="arpsmash.h::t1_hw" ref="ecbd64d70ba93895baf559fe1e51c240" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>* <a class="el" href="arpsmash_8h.html#ecbd64d70ba93895baf559fe1e51c240">t1_hw</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Targets' HW addresses. 
<p>

</div>
</div><p>
<a class="anchor" name="ff8d675c54f18c668a5f1edabf2a0e2c"></a><!-- doxytag: member="arpsmash.h::t2" ref="ff8d675c54f18c668a5f1edabf2a0e2c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> * <a class="el" href="arpsmash_8h.html#ff8d675c54f18c668a5f1edabf2a0e2c">t2</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="f05aa100ccc9224db3be71d851d301cd"></a><!-- doxytag: member="arpsmash.h::t2_hw" ref="f05aa100ccc9224db3be71d851d301cd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a> * <a class="el" href="arpsmash_8h.html#f05aa100ccc9224db3be71d851d301cd">t2_hw</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="12c7a29c2aaefb6be3e9e2159acf74d9"></a><!-- doxytag: member="arpsmash.h::t_hw" ref="12c7a29c2aaefb6be3e9e2159acf74d9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arpsmash_8h.html#b291f552d5fd4d65ac668d6b2b180919">__u8</a>* <a class="el" href="arpsmash_8h.html#12c7a29c2aaefb6be3e9e2159acf74d9">t_hw</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
My HW address. 
<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jan 12 23:09:18 2009 for tcpsmash by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
